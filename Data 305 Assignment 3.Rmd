---
title: "Data 305 Assignment 3"
Author: "Muhammad Maqsood"
output: html_notebook
---

## Probability Models of Continuous Random Variables (CRV),Specific Types of Continuous Probability Models, and Exploring Data

**Question 1:(9 marks)** A random variable X has the following probability density function

$$
\begin{aligned}
f(x)= \frac{e^{-|x|}}{2}, \,\,\,\,for\,\,  -12 \leq x \leq 12
\end{aligned}
$$
**1a:(3 marks)** What is the graph of this probability distribution?
```{r}
pdf1a = function(x){
  exp(-abs(x))/2
}
curve(pdf1a, -12, 12, xlab = "Values of X", ylab = "f(x) = Density of X", main = "Distribution of X", col = "blue")
```

</br>
</br>
**1b:(3 marks)** Compute P(0<X<1) by using the integration in R.
```{r}
integrate(pdf1a, lower = 0, upper = 1)$value
```
</br>
</br>
**1c:(3 marks)** Compute $P(X \geq 7)$ by using the integration in R.
```{r}
1 - integrate(pdf1a, lower = -12, upper = 7)$value
```

</br>
</br>
**Question 2:(5 marks)** Let

$$
\begin{aligned}
f(x)=
\begin{cases}
0,&\text{elsewhere} \\
cx^2&\text{if   }0 \leq x \leq 2\\
\end{cases}
\end{aligned}
$$


**2a:(3 marks)** Find the value of c for which f(x) is a valid probability density function (pdf).
$$
\int[0,2] cx^{2} dx = 1 \\\ = c*\int[0,2]x^{2} dx \\\ = c*\frac{x^{3}}{3} \\\ c*\frac{2^{3}}{3} - c*\frac{0^{3}}{3} = 1 \\\ c*\frac{8}{3} = 1 \\\ c = \frac{3}{8}
$$
```{r}
# ∫[0,2] c*(x^2) dx = c * ∫[0,2] x^2 dx = c * [x^3/3]_0^2 = (8/3) * c ; (8/3) *c = 1 ; c = 3/8

pdf2a = function(x){
  (3/8)*(x^2)
}

```

</br>
</br>

**2b:(2 marks)** Compute $P(X\leq1.5)$ by using the integration in R.
```{r}
integrate(pdf2a, lower = 0, upper = 1.5)$value
```

</br>
</br>

**Question 3:(12 marks)** The cumulative distribution function for a random variable X is of the form 

$$
\begin{aligned}
F(x)=
\begin{cases}
0,&\text{if} \,\, x\leq 0\\
sin\,x&\text{if}\,\,0<x \leq \pi/2\,\,(1.570796327)\\
1\ &\text{if}\,\,x > \pi/2\\
\end{cases}
\end{aligned}
$$

**3a:(3 marks)** With R, visualize the cumulative distribution function of X from -1 to 2. Hint: Review Lab Exercise 4 in Lab 3 folder.
```{r}
func3a = function(x){
  (x<=0)*(0)+(x>0 & x<=(pi/2))*(sin(x))+(x>(pi/2))*(1)
  }
vectfunc3a = Vectorize(func3a)
plot(vectfunc3a,-1,2, type = "l", col = "red", ylab = "F(x)", main = "Piecewise Cumulative Distribution Function of X")
```

</br>
</br>
**3b:(3 marks)** Compute $P(0.1 <X <0.2)$ by using the CDF above.
```{r}
func3a(0.2) - func3a(0.1)
```

</br>
</br>
**3c:(3 marks)** With R, find the probability density function of X,by using the differentiation in R.
```{r}
D(expression(sin(x)), "x")
```

</br>
</br>
**3d:(3 marks)** With R, find E(X)
```{r}
ex2ev3d = function(x){
  x*cos(x)*(x>0 & x<=(pi/2))
}
ev3d = integrate(ex2ev3d, lower = 0, upper = pi/2)$value
ev3d # E(x)

```

</br>
</br>

**Question 4:(13 marks)** Suppose

$$
\begin{aligned}
f(x)=
\begin{cases}
1-x,&\text{when   } 0\leq x\leq 1\\
\frac{1}{2}&\text{when   }2\leq x \leq 3
\end{cases}
\end{aligned}
$$


**4a:(3 marks)** With R, visualize the probability density function of X from -1 to 4. Hint: Review Lab Exercise 4 in Lab 3 folder.
```{r}
func4a = function(x){
  (x>=0 & x<=1)*(1-x) + (x>=2 & x<=3)*(1/2)
}
vectfunc4a = Vectorize(func4a)
plot(vectfunc4a,-1,4, type = "l", col = "red", ylab = "f(x)", main = "Piecewise Cumulative Distribution Function of X")
```

</br>
</br>

**4b:(4 marks)** From the pdf function graphs in part a), find the total area beneath the PDFs by using Basic Geometry Formulas. What can you conclude about your result?
$$
Area Of Triangle = \frac{b*h}{2} \\\ = \frac{1*1}{2} \\\ = \frac{1}{2} \\\
\\\
Area of Rectangle = b*h \\\ = 1*0.5 \\\ = 0.5=\frac{1}{2} \\\
\\\
Total Area = \frac{1}{2} + \frac{1}{2} = 1
$$
# We can conclude that the area under the curve is 1 using the basic geometry formulas for area

</br>
</br>

**4c:(3 marks)** With R, compute E(X)
```{r}
func4c = function(x){
  x*(x>=0 & x<=1)*(1-x) + x*(x>=2 & x<=3)*(1/2)
} 
evx4c = integrate(func4c, lower = 0, upper = 1)$value + integrate(func4c, lower = 2, upper = 3)$value
evx4c # E(x)
```

Hint:

$$
\begin{aligned}
E(x)= \int_{all\,x}   xf(x) dx=\int_0^{1} xf(x)dx+\int_2^{3} xf(x)dx
\end{aligned}
$$
</br>
</br>

**4d:(3 marks)** With R, compute the standard deviation of (X),  $\sigma_x$
```{r}
func4d = function(x){
  (x^2)*(x>=0 & x<=1)*(1-x) + (x^2)*(x>=2 & x<=3)*(1/2)
}
m24d = integrate(func4d, lower = 0, upper = 1)$value + integrate(func4d, lower = 2, upper = 3)$value
m24d

sdx4d = sqrt(m24d - evx4c^{2})
sdx4d # SD(x)
```

</br>
</br>
**Question 5:(8 marks)** An online random number generator uniformly generates numbers between 0 to 10. Let X be a number generated by this generator.
```{r}
x5 = runif(1000, 0, 10)
```

</br>
</br>
**5a:(4 marks)**What is the probability density function of X? What does the distribution of X look like?
$$
f(x) = \frac{1}{10} \ \ \ for \ 0 \leq x \leq 10
$$
```{r}
pdf5a = function(x){
  1/10
}
xq5 = seq(-5,15, 0.1)
plot(xq5, dunif(xq5, 0, 10), xlim=c(-10, 20), ylim=c(0, 1/9), xlab = "X", ylab="f(x)", main="Probability Distribution of Cycling Time", type="l", col='blue')
```

</br>
</br>

**5b:(2 marks)**With R, compute the probability that a number generated is between 2 to 8.
```{r}
punif(8, 0, 10) - punif(2, 0, 10)
```

</br>
</br>
**5c:(2 marks)** Compute the 75th percentile of this distribution, $x_{75}$, and interpret its meaning in the context of these data.
```{r}
qunif(0.75, 0, 10) # x75th
```

</br>
</br>


**Question 6:(6 marks)** On average, commuters in Calgary area require  25 minutes to get to work. Assuming normal distribution with a standard deviation of 5 minutes, and a randomly selected commuter named Evan;

**6a:(2 marks)** What is the probability that Evan will require more than 27 minutes to get to work?
```{r}
# P(X > 27)
1 - pnorm(27, 25, 5)
```

</br>
</br>


**6b:(2 marks)** Evan told his friend that it took less than 10 minute to get to work. Evaluate the probability of his claim.
```{r}
pnorm(10, 25, 5)
```

</br>
</br>


**6c:(2 marks)** Evan usually leaves his home at 8 am. His boss claims that 2.27501% of the commuting times, he comes to work late. What is **the earliest late arrival time** does he arrive to his work? Use at least seven decimal place in R for your calculation
```{r}
qnorm(0.0227501, 25,5)
```

</br>
</br>


**Question 7:(12 marks)** A random variable X has the following probability density function

$$
f(x) = \frac{1}{\Gamma(6)*2^{6}}x^5e^{-x/2} \hspace{0.2in} for\,\,x \geq 0
$$

**7a:(2 marks)** Identify the distribution of X. Be specific.
```{r}
# The Distribution of X is a Gamma distribution as the PDF contains the beta = 2 and alpha = 6. Both also satisfy the condition of being non-negative.
pdf7a = function(x){
  (1/(gamma(6)*(2^6)))*((x^5)*exp(-x/2))
}
```

</br>
</br>

**7b:(2 marks)**  Use R Studio to visualize this distribution.
```{r}
curve(pdf7a, 0, 80, xlab="X", ylab="f(x)", col="red", main="Gamma Distribution of X")
```

</br>
</br>

**7c:(2 marks)** Find the $E(X) = μ_X \text{ and the } SD(X) = σ_X$.
```{r}
# Since the PDF follows a gamma distribution we can use the formulas for E(x) and SD(x)
alpha7 = 6
beta7 = 2
evx7c = alpha7*beta7
evx7c # E(x)
sdx7c = sqrt(alpha7*(beta7^2))
sdx7c # SD(x)
```

</br>
</br>

**7d:(2 marks)** Compute P(8 ≤X ≤13).
```{r}
pgamma(13, 6, 1/2) - pgamma(8, 6, 1/2)
```

</br>
</br>

**7e:(2 marks)** Compute P(X > 20)
```{r}
1 - pgamma(20, 6, 1/2)
```

</br>
</br>

**7f:(2 marks)** Find the 95th percentile of X, $x_{95}$
```{r}
qgamma(0.95, 6, 1/2)
```

</br>
</br>



**Question 8:(10 marks)** Consider the function

$$
\begin{aligned}
f(x)=cx^2e^{\frac{-x}{2}},x\geq0
\end{aligned}
$$

**8a:(4 marks)** Find the value of the constant c such that f(x) is a valid pdf.Hint: You need to apply the properties of the gamma function to solve this question.
$$
c = \frac{1}{\Gamma(3)*2^3}; \\\ \\ \alpha = 3 , \beta = 2
$$
$$
\begin{aligned}
Completed \ f(x)=\frac{1}{\Gamma(3)*2^3}x^2e^{\frac{-x}{2}}, \ x\geq0
\end{aligned}
$$
</br>
</br>

**8b:(2 marks)** From part a, compute P(3<X<10) by using both R function and the built in R command.
```{r}
pdf8b = function(x){
  (1/(gamma(3)*(2^3)))*((x^2)*exp(-x/2))
}
integrate(pdf8b, lower = 3, upper = 10)$value
pgamma(10, 3, 1/2) - pgamma(3, 3, 1/2)
```

</br>
</br>

**8c:(2 marks)** From part a, compute P(X>20) by using the built in R command.
```{r}
1 - pgamma(20, 3, 1/2)
```
</br>
</br>
**8d:(2 marks)**Create the graph of this probability distribution where $\alpha=3,\beta=2$.
```{r}
curve(pdf8b, 0, 80, xlab="X", ylab="f(x)", col="red", main="Gamma Distribution of X")
```

</br>
</br>



**Question 9:(9 marks)** Calls to the "911" number of a large community in Calgary have been found to be Poisson distributed with an average of 2 calls per minute.

Let X represent the amount of time waiting between successive calls.

**9a:(2 marks)**Identify the distribution of X.
```{r}
# X follows an exponential distribution.
```

$$
\begin{aligned}
f(x)=\lambda e^{-\lambda x},\ x\geq0 \ and \ \lambda\geq0
\end{aligned}
$$
```{r}
pdf9a = function(x){
  2 * exp(-2 * x)
}
```

</br>
</br>

**9b:(2 marks)**Compute the probability that a person will wait at most 20 seconds for an officer to answer their call?
```{r}
# P(X <= 20)
pexp(20, 1/0.5)
1 - pdf9a(20)
```

</br>
</br>

**9c:(3 marks)**If it takes at least 10 second to an officer to answer the next call, compute the probablity that it takes at most 15 seconds in total for the next available agent.
```{r}
# P(X <= 15 | X >= 10) ; P(X <= 15-10) = P(X <= 5)
pexp(5, 1/0.5)
```

</br>
</br>

**9d:(2 marks)**Create the graph of this probability distribution by using the plot() command. (Use x= seq(0,1,0.05))
```{r}
x9d = seq(0,1,0.05)
plot(x9d, pdf9a(x9d), xlab = "Time for police to answer 911 call", ylab = "f(x)", main = "Distribution of Police calls", type = "l", col = "blue")
plot(x9d, dexp(x9d,1/0.5), xlab = "Time for police to answer 911 call", ylab = "f(x)", main = "Distribution of Police calls", type = "l", col = "red") # Same Graph
```

</br>
</br>



**Question 10:(6 marks)** Suppose it is known that the age at which an individual contracts HIV from sexual activity follow a chi-square distribution with $\nu$= 12 (the degree of freedom=12)

**10a:(2 marks)**Use the plot() command along with the dchisq(x,df)command to create a Chi-Square Distribution (Use x= seq(0,100,1))
```{r}
x10a = seq(0,100,1)
plot(x10a, dchisq(x10a, 12), xlab = "Values of X", ylab = "f(x)", main = "Chi-square distribution of X", type = "l", col = "blue")
```

</br>
</br>


**10b:(2 marks)**What is the probability of an individual contracting HIV at an age more than 50 year old.
```{r}
# P(X > 50)
1 - pchisq(50, 12) 
```

</br>
</br>


**10c:(2 marks)** 90% of individuals who are contracting HIV are lower than what age? Do not round your answer.
```{r}
qchisq(0.90, 12)
```

</br>
</br>



**Note! Please ensure you watch videos posted in Lab 3 folder before completing Question 11**

**Question 11:(14 marks)** The data file GSS2002.csv that was previously referred to in class consists of data resulting from
the General Social Survey (GSS) that tracks various demographic, characteristics, and views on social and
political issues since the early 1970s. This file can be imported into R with the following command

```{r}
gss = read.csv("http://people.ucalgary.ca/~jbstall/DataFiles/GSS2002.csv")
```


This data set consists of a various categorical variables. You can run the head(gss, of rows to see) command to inspect the different variable names. Or, the command colnames(gss) will return the names of the different columns/variables. To determine the different values that are possible on a certain categorical variable, the command **levels(dataframename$variablename)** will return the different values. For example: 
```{r}
head(gss, 3)
colnames(gss)
levels(gss$Religion)
```

For example, **Command levels(gss$Religion)** will return 13 levels of Categorical variable-Religion which are Buddhism, Catholic, Christian, Hinduism, Inter-nondenominational, Jewish, Moslem/Islam, Native American, None,Orthodox-Christian, Other, Other Eastern, and Protestant.

**11a:(4 marks)** Provide **a sorted bar graph** that shows the distribution of Religion, with the y-axis being the proportion
of persons who fall into each religious category.
```{r}
library(ggplot2)
ggplot(data = gss, aes(x = reorder(Religion,Religion, function(x)- length(x)))) + xlab("Religion") + ylab("Count of Persons")+ geom_bar(fill="navyblue") + ggtitle("Distribution of Religion") + theme(axis.text.x = element_text(face="plain", color="maroon", size = 8, angle=30))
```


**Note: A guide to customize tick mark labels**

You can change the appearance of the axis tick mark labels by adding the command ** + theme(axis.text.x= element_text(family, face, colour, size))** in ggplot()

family : font family

face : font face. Possible values are “plain”, “italic”, “bold” and “bold.italic”

colour : text color

size : text size in pts

angle : angle (in [0, 360])

For example, you could copy and paste this command: +theme(axis.text.x = element_text(face="plain", color="#993333", size=10, angle=90)) into ggplot() 


</br>
</br>


**11b:(4 marks)** Create a bar graph that can be used to demonstrate if there is a relationship between one’s Gender and their Political Views. Comment on your findings, providing a brief two/three sentence statement.
```{r}
ggplot(data = gss, aes(x = Politics, fill = Gender)) + ylab("Count of Persons") +geom_bar(position = "dodge") + ggtitle("Distribution of Gender and Political Views") + theme(axis.text.x = element_text(face="plain", color="purple", size = 8, angle=20))

# Based of the bar graph created, we can derive that majority of individuals do not hold certain political views (NA) or fall right in between being conservative or liberal (Moderate). We can see that majority of females are more conservative then liberal, although the distribution looks fairly similar for both genders.
```


</br>
</br>


**11c:(6 marks)** Create "a conditional pecentage" or "conditional proportion (aka conditional probability)" bargraph that can be used to demonstrate if there is a relationship between one’s marital status (Marital) and their education level which Education variable belongs on the x-axis. Comment on your findings,providing a brief two/three sentence statement.
```{r}
table(gss$Education)
```

```{r}
counts1 = as.data.frame(table(gss$Education, gss$Marital))
counts1

n.ba = 443
n.gr = 230
n.hs = 1485
n.jr = 202
n.lhs = 400
```
```{r}
countwithpropbyeduc = c(66/n.ba,33/n.gr,264/n.hs,34/n.jr,48/n.lhs,227/n.ba,128/n.gr,660/n.hs,113/n.jr,141/n.lhs,119/n.ba,50/n.gr,382/n.hs,43/n.jr,111/n.lhs,9/n.ba,4/n.gr,51/n.hs,9/n.jr,22/n.lhs,22/n.ba,15/n.gr,128/n.hs,3/n.jr,78/n.lhs)
countwithpropbyeduc

df=data.frame(counts1, countwithpropbyeduc)
df
```


```{r}
ggplot(data = df, aes(x = Var1, y = countwithpropbyeduc, fill = Var2)) + xlab("Education") + geom_bar(stat = "identity", position = "dodge") + ggtitle("Distribution of Marital Status For Education")
# Based on this graph we can see that the percentage of Married individuals for each level of education is higher than any other marital status. Showing that most levels of education have married individuals. Those who left high school have the lowest percentage of married and highest percentage of never married individuals. Those with a Higher level of education seems like are either Married or never married, with very low percentage of separated or widowed. Although the percentage of divorced is still there. This graph also statistically supports that "(almost) 50% of marriages end in divorce" regardless of education level. 
```


</br>
</br>


---------------------------------------------------------------------




